<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIOãƒã‚§ãƒƒã‚«ãƒ¼ - ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .header h1 {
            color: #1e3a8a;
            font-size: 36px;
            font-weight: 800;
        }

        .header p {
            color: #64748b;
            font-size: 16px;
            margin-top: 8px;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1e3a8a 100%);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 5px;
        }

        .tab {
            padding: 15px 30px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #1e3a8a;
            white-space: nowrap;
        }

        .tab:hover {
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .tab.active {
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 32px;
            font-weight: 800;
            color: #1e3a8a;
        }

        .stat-change {
            font-size: 13px;
            margin-top: 8px;
            font-weight: 600;
        }

        .stat-change.positive {
            color: #10b981;
        }

        .stat-change.negative {
            color: #ef4444;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .section-title {
            font-size: 24px;
            color: #1e3a8a;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th {
            background: #f1f5f9;
            padding: 15px;
            text-align: left;
            font-size: 13px;
            font-weight: 700;
            color: #475569;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid #e2e8f0;
            font-size: 14px;
            color: #334155;
        }

        .data-table tr:hover {
            background: #f8fafc;
        }

        .status-pill {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-pill.success {
            background: #d1fae5;
            color: #065f46;
        }

        .status-pill.error {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-pill.warning {
            background: #fef3c7;
            color: #92400e;
        }

        .status-pill.info {
            background: #dbeafe;
            color: #1e40af;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .chart-card {
            background: #f9fafb;
            border-radius: 12px;
            padding: 25px;
        }

        .chart-card h3 {
            font-size: 18px;
            color: #1e3a8a;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .config-form {
            display: grid;
            gap: 20px;
        }

        .form-group {
            display: grid;
            gap: 8px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: #334155;
        }

        .form-input {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .keyword-manager {
            display: grid;
            gap: 15px;
        }

        .keyword-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: #f9fafb;
            border-radius: 10px;
            border: 2px solid #e5e7eb;
        }

        .keyword-info {
            flex: 1;
        }

        .keyword-name {
            font-size: 16px;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 5px;
        }

        .keyword-meta {
            font-size: 13px;
            color: #6b7280;
        }

        .keyword-actions {
            display: flex;
            gap: 10px;
        }

        .icon-btn {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .icon-btn.edit {
            background: #dbeafe;
            color: #1e40af;
        }

        .icon-btn.delete {
            background: #fee2e2;
            color: #991b1b;
        }

        .icon-btn:hover {
            transform: scale(1.1);
        }

        .system-logs {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            line-height: 1.8;
        }

        .log-entry {
            margin-bottom: 8px;
        }

        .log-time {
            color: #94a3b8;
        }

        .log-level {
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 4px;
            margin: 0 8px;
        }

        .log-level.info {
            background: #1e40af;
            color: white;
        }

        .log-level.warn {
            background: #d97706;
            color: white;
        }

        .log-level.error {
            background: #991b1b;
            color: white;
        }

        .api-status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .api-card {
            background: linear-gradient(135deg, #f9fafb 0%, #ffffff 100%);
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
        }

        .api-card.active {
            border-color: #10b981;
            background: linear-gradient(135deg, #d1fae5 0%, #ffffff 100%);
        }

        .api-card.inactive {
            border-color: #ef4444;
            background: linear-gradient(135deg, #fee2e2 0%, #ffffff 100%);
        }

        .api-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .api-name {
            font-size: 16px;
            font-weight: 700;
            color: #1e3a8a;
        }

        .api-status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .api-status-dot.active {
            background: #10b981;
            box-shadow: 0 0 10px #10b981;
        }

        .api-status-dot.inactive {
            background: #ef4444;
            box-shadow: 0 0 10px #ef4444;
        }

        .api-details {
            font-size: 13px;
            color: #64748b;
            line-height: 1.6;
        }

        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }

        input[type="file"] {
            display: none;
        }

        @media (max-width: 768px) {
            .stats-overview {
                grid-template-columns: 1fr;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }

            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div>
                    <h1>âš™ï¸ ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
                    <p>AIOè¡¨ç¤ºãƒã‚§ãƒƒã‚«ãƒ¼ - ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ã‚³ãƒ³ã‚½ãƒ¼ãƒ«</p>
                </div>
                <div class="header-actions">
                    <label for="file-upload" class="btn btn-primary">
                        <span>ğŸ“</span>
                        <span>ãƒ‡ãƒ¼ã‚¿èª­è¾¼</span>
                    </label>
                    <input id="file-upload" type="file" accept=".json" onchange="loadData(event)">
                    <button class="btn btn-success" onclick="exportAllData()">
                        <span>ğŸ’¾</span>
                        <span>CSVå‡ºåŠ›</span>
                    </button>
                    <button class="btn btn-warning" onclick="refreshData()">
                        <span>ğŸ”„</span>
                        <span>æ›´æ–°</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('overview')">ğŸ“Š æ¦‚è¦</button>
            <button class="tab" onclick="switchTab('keywords')">ğŸ”‘ ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç†</button>
            <button class="tab" onclick="switchTab('apis')">ğŸŒ APIçŠ¶æ…‹</button>
            <button class="tab" onclick="switchTab('analytics')">ğŸ“ˆ è©³ç´°åˆ†æ</button>
            <button class="tab" onclick="switchTab('config')">âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</button>
            <button class="tab" onclick="switchTab('logs')">ğŸ“‹ ãƒ­ã‚°</button>
        </div>

        <!-- æ¦‚è¦ã‚¿ãƒ– -->
        <div id="overview" class="tab-content active">
            <div class="stats-overview">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ¯</div>
                    <div class="stat-label">ç·å®Ÿè¡Œå›æ•°</div>
                    <div class="stat-value" id="total-runs">0</div>
                    <div class="stat-change positive" id="runs-change">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">âœ…</div>
                    <div class="stat-label">æˆåŠŸç‡</div>
                    <div class="stat-value" id="success-rate">0%</div>
                    <div class="stat-change positive" id="success-change">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">â­</div>
                    <div class="stat-label">AIOå¼•ç”¨ç‡</div>
                    <div class="stat-value" id="aio-rate">0%</div>
                    <div class="stat-change positive" id="aio-change">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">ğŸ¤–</div>
                    <div class="stat-label">LLMå¼•ç”¨ç‡</div>
                    <div class="stat-value" id="llm-rate">0%</div>
                    <div class="stat-change positive" id="llm-change">+0%</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">ğŸ“ˆ</div>
                    <div class="stat-label">å¹³å‡é †ä½</div>
                    <div class="stat-value" id="avg-position">-</div>
                    <div class="stat-change positive" id="position-change">+0</div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">ğŸ”</div>
                    <div class="stat-label">ç›£è¦–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</div>
                    <div class="stat-value" id="total-keywords-stat">0</div>
                    <div class="stat-change info">ã‚¢ã‚¯ãƒ†ã‚£ãƒ–</div>
                </div>
            </div>

            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span>ğŸ“Š</span>
                        <span>æœ€æ–°å®Ÿè¡Œçµæœ</span>
                    </h2>
                </div>
                <table class="data-table" id="recent-results">
                    <thead>
                        <tr>
                            <th>å®Ÿè¡Œæ—¥æ™‚</th>
                            <th>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</th>
                            <th>ã‚¨ãƒ³ã‚¸ãƒ³</th>
                            <th>ãƒ‡ãƒã‚¤ã‚¹</th>
                            <th>AIOè¡¨ç¤º</th>
                            <th>è‡ªç¤¾å¼•ç”¨</th>
                            <th>é †ä½</th>
                            <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="8" class="no-data">ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="chart-grid">
                <div class="chart-card">
                    <h3>æ™‚ç³»åˆ—ãƒˆãƒ¬ãƒ³ãƒ‰</h3>
                    <canvas id="trendChart"></canvas>
                </div>
                <div class="chart-card">
                    <h3>LLMã‚¨ãƒ³ã‚¸ãƒ³åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</h3>
                    <canvas id="llmPerfChart"></canvas>
                </div>
            </div>
        </div>

        <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ã‚¿ãƒ– -->
        <div id="keywords" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span>ğŸ”‘</span>
                        <span>ç›£è¦–ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è¦§</span>
                    </h2>
                    <button class="btn btn-primary" onclick="addKeyword()">
                        <span>â•</span>
                        <span>æ–°è¦è¿½åŠ </span>
                    </button>
                </div>
                <div class="keyword-manager" id="keyword-list">
                    <div class="no-data">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚“ã§ãã ã•ã„</div>
                </div>
            </div>
        </div>

        <!-- APIçŠ¶æ…‹ã‚¿ãƒ– -->
        <div id="apis" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span>ğŸŒ</span>
                        <span>å¤–éƒ¨APIæ¥ç¶šçŠ¶æ…‹</span>
                    </h2>
                </div>
                <div class="api-status-grid">
                    <div class="api-card" id="serpapi-status">
                        <div class="api-header">
                            <div class="api-name">SerpAPI</div>
                            <div class="api-status-dot"></div>
                        </div>
                        <div class="api-details">
                            <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong>æœªç¢ºèª</strong></div>
                            <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                            <div>æˆåŠŸç‡: -%</div>
                        </div>
                    </div>

                    <div class="api-card" id="claude-status">
                        <div class="api-header">
                            <div class="api-name">Claude API</div>
                            <div class="api-status-dot"></div>
                        </div>
                        <div class="api-details">
                            <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong>æœªç¢ºèª</strong></div>
                            <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                            <div>æˆåŠŸç‡: -%</div>
                        </div>
                    </div>

                    <div class="api-card" id="chatgpt-status">
                        <div class="api-header">
                            <div class="api-name">ChatGPT API</div>
                            <div class="api-status-dot"></div>
                        </div>
                        <div class="api-details">
                            <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong>æœªç¢ºèª</strong></div>
                            <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                            <div>æˆåŠŸç‡: -%</div>
                        </div>
                    </div>

                    <div class="api-card" id="gemini-status">
                        <div class="api-header">
                            <div class="api-name">Gemini API</div>
                            <div class="api-status-dot"></div>
                        </div>
                        <div class="api-details">
                            <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong>æœªç¢ºèª</strong></div>
                            <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                            <div>æˆåŠŸç‡: -%</div>
                        </div>
                    </div>

                    <div class="api-card" id="sheets-status">
                        <div class="api-header">
                            <div class="api-name">Google Sheets</div>
                            <div class="api-status-dot"></div>
                        </div>
                        <div class="api-details">
                            <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong>æœªç¢ºèª</strong></div>
                            <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                            <div>æˆåŠŸç‡: -%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- è©³ç´°åˆ†æã‚¿ãƒ– -->
        <div id="analytics" class="tab-content">
            <div class="section">
                <h2 class="section-title">
                    <span>ğŸ“ˆ</span>
                    <span>è©³ç´°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ</span>
                </h2>
                <div class="chart-grid">
                    <div class="chart-card">
                        <h3>æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³åˆ¥æˆåŠŸç‡</h3>
                        <canvas id="engineSuccessChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>ãƒ‡ãƒã‚¤ã‚¹åˆ¥AIOè¡¨ç¤ºç‡</h3>
                        <canvas id="deviceAioChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>é †ä½åˆ†å¸ƒ</h3>
                        <canvas id="rankDistChart"></canvas>
                    </div>
                    <div class="chart-card">
                        <h3>LLMå¼•ç”¨è©³ç´°</h3>
                        <canvas id="llmDetailChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã‚¿ãƒ– -->
        <div id="config" class="tab-content">
            <div class="section">
                <h2 class="section-title">
                    <span>âš™ï¸</span>
                    <span>ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</span>
                </h2>
                <div class="config-form">
                    <div class="form-group">
                        <label class="form-label">SerpAPI ã‚­ãƒ¼</label>
                        <input type="password" class="form-input" placeholder="your_serpapi_key_here" value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Anthropic API ã‚­ãƒ¼ (Claude)</label>
                        <input type="password" class="form-input" placeholder="sk-ant-..." value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>

                    <div class="form-group">
                        <label class="form-label">OpenAI API ã‚­ãƒ¼ (ChatGPT)</label>
                        <input type="password" class="form-input" placeholder="sk-..." value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Google AI API ã‚­ãƒ¼ (Gemini)</label>
                        <input type="password" class="form-input" placeholder="AI..." value="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Google Sheets ID</label>
                        <input type="text" class="form-input" placeholder="1ABC...xyz">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</label>
                        <textarea class="form-input form-textarea" placeholder="example.com, your-domain.com"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</label>
                        <select class="form-input">
                            <option>æ¯æ—¥ 9:00</option>
                            <option>æ¯é€±æœˆæ›œ 9:00</option>
                            <option>æ‰‹å‹•å®Ÿè¡Œã®ã¿</option>
                        </select>
                    </div>

                    <button class="btn btn-success" style="justify-self: start;">
                        <span>ğŸ’¾</span>
                        <span>è¨­å®šã‚’ä¿å­˜</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- ãƒ­ã‚°ã‚¿ãƒ– -->
        <div id="logs" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">
                        <span>ğŸ“‹</span>
                        <span>ã‚·ã‚¹ãƒ†ãƒ ãƒ­ã‚°</span>
                    </h2>
                    <button class="btn btn-primary" onclick="clearLogs()">
                        <span>ğŸ—‘ï¸</span>
                        <span>ãƒ­ã‚°ã‚¯ãƒªã‚¢</span>
                    </button>
                </div>
                <div class="system-logs" id="system-logs">
                    <div class="log-entry">
                        <span class="log-time">[2025-10-08 12:30:45]</span>
                        <span class="log-level info">INFO</span>
                        <span>ã‚·ã‚¹ãƒ†ãƒ èµ·å‹•å®Œäº†</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-time">[2025-10-08 12:31:00]</span>
                        <span class="log-level info">INFO</span>
                        <span>SerpAPIæ¥ç¶šæˆåŠŸ</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-time">[2025-10-08 12:31:05]</span>
                        <span class="log-level info">INFO</span>
                        <span>Claude APIæ¥ç¶šæˆåŠŸ</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-time">[2025-10-08 12:31:10]</span>
                        <span class="log-level warn">WARN</span>
                        <span>Google Sheets credentials not found - using mock data</span>
                    </div>
                    <div class="log-entry">
                        <span class="log-time">[2025-10-08 12:31:15]</span>
                        <span class="log-level info">INFO</span>
                        <span>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¨­å®šèª­ã¿è¾¼ã¿å®Œäº†: 2ä»¶</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentData = null;
        let charts = {};

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function loadData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    currentData = Array.isArray(data) ? data : [data];
                    updateDashboard(currentData);
                    addLog('info', `ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†: ${currentData.length}ä»¶`);
                } catch (error) {
                    addLog('error', 'ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: ' + error.message);
                    alert('ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            };
            reader.readAsText(file);
        }

        function updateDashboard(data) {
            // çµ±è¨ˆæ›´æ–°
            const totalRuns = data.length;
            const successRuns = data.filter(d => d.job_status === 'ok').length;
            const successRate = Math.round((successRuns / totalRuns) * 100);

            const aioPresent = data.filter(d => d.aio_present).length;
            const aioRate = Math.round((aioPresent / totalRuns) * 100);

            let llmCitations = 0, llmTotal = 0;
            data.forEach(d => {
                if (d.llm_results) {
                    llmTotal += d.llm_results.length;
                    llmCitations += d.llm_results.filter(llm => llm.llm_own_cited).length;
                }
            });
            const llmRate = llmTotal > 0 ? Math.round((llmCitations / llmTotal) * 100) : 0;

            const rankedResults = data.filter(d => d.serp_rank && d.serp_rank > 0);
            const avgPosition = rankedResults.length > 0
                ? Math.round(rankedResults.reduce((sum, d) => sum + d.serp_rank, 0) / rankedResults.length)
                : '-';

            const uniqueKeywords = new Set(data.map(d => d.keyword)).size;

            document.getElementById('total-runs').textContent = totalRuns;
            document.getElementById('success-rate').textContent = successRate + '%';
            document.getElementById('aio-rate').textContent = aioRate + '%';
            document.getElementById('llm-rate').textContent = llmRate + '%';
            document.getElementById('avg-position').textContent = avgPosition === '-' ? avgPosition : avgPosition + 'ä½';
            document.getElementById('total-keywords-stat').textContent = uniqueKeywords;

            // ãƒ†ãƒ¼ãƒ–ãƒ«æ›´æ–°
            updateResultsTable(data);

            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è¦§æ›´æ–°
            updateKeywordList(data);

            // APIçŠ¶æ…‹æ›´æ–°
            updateApiStatus(data);

            // ãƒãƒ£ãƒ¼ãƒˆæ›´æ–°
            updateCharts(data);
        }

        function updateResultsTable(data) {
            const tbody = document.querySelector('#recent-results tbody');
            tbody.innerHTML = '';

            data.slice(0, 10).forEach(result => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${new Date(result.run_at).toLocaleString('ja-JP')}</td>
                    <td><strong>${result.keyword}</strong></td>
                    <td>${result.engine.toUpperCase()}</td>
                    <td>${result.device === 'desktop' ? 'ğŸ–¥ï¸ PC' : 'ğŸ“± ãƒ¢ãƒã‚¤ãƒ«'}</td>
                    <td><span class="status-pill ${result.aio_present ? 'success' : 'warning'}">${result.aio_present ? 'è¡¨ç¤ºã‚ã‚Š' : 'è¡¨ç¤ºãªã—'}</span></td>
                    <td><span class="status-pill ${result.own_cited ? 'success' : 'info'}">${result.own_cited ? 'å¼•ç”¨ã‚ã‚Š' : 'å¼•ç”¨ãªã—'}</span></td>
                    <td>${result.serp_rank || 'åœå¤–'}</td>
                    <td><span class="status-pill ${result.job_status === 'ok' ? 'success' : 'error'}">${result.job_status === 'ok' ? 'æˆåŠŸ' : 'å¤±æ•—'}</span></td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateKeywordList(data) {
            const container = document.getElementById('keyword-list');
            const keywords = {};

            data.forEach(d => {
                if (!keywords[d.keyword]) {
                    keywords[d.keyword] = {
                        keyword: d.keyword,
                        lang: d.lang,
                        device: d.device,
                        runs: 0,
                        success: 0
                    };
                }
                keywords[d.keyword].runs++;
                if (d.job_status === 'ok') keywords[d.keyword].success++;
            });

            container.innerHTML = '';
            Object.values(keywords).forEach(kw => {
                const item = document.createElement('div');
                item.className = 'keyword-item';
                item.innerHTML = `
                    <div class="keyword-info">
                        <div class="keyword-name">${kw.keyword}</div>
                        <div class="keyword-meta">è¨€èª: ${kw.lang} | ãƒ‡ãƒã‚¤ã‚¹: ${kw.device} | å®Ÿè¡Œå›æ•°: ${kw.runs} | æˆåŠŸç‡: ${Math.round((kw.success/kw.runs)*100)}%</div>
                    </div>
                    <div class="keyword-actions">
                        <button class="icon-btn edit" onclick="editKeyword('${kw.keyword}')">âœï¸</button>
                        <button class="icon-btn delete" onclick="deleteKeyword('${kw.keyword}')">ğŸ—‘ï¸</button>
                    </div>
                `;
                container.appendChild(item);
            });
        }

        function updateApiStatus(data) {
            // Mock API status based on data
            const hasSerp = data.some(d => d.serp_top100 && d.serp_top100.length > 0);
            const hasClaude = data.some(d => d.llm_results && d.llm_results.find(llm => llm.llm_engine === 'claude'));
            const hasChatGPT = data.some(d => d.llm_results && d.llm_results.find(llm => llm.llm_engine === 'chatgpt'));
            const hasGemini = data.some(d => d.llm_results && d.llm_results.find(llm => llm.llm_engine === 'gemini'));

            updateApiCard('serpapi-status', hasSerp);
            updateApiCard('claude-status', hasClaude);
            updateApiCard('chatgpt-status', hasChatGPT);
            updateApiCard('gemini-status', hasGemini);
        }

        function updateApiCard(cardId, isActive) {
            const card = document.getElementById(cardId);
            const dot = card.querySelector('.api-status-dot');
            const details = card.querySelector('.api-details');

            if (isActive) {
                card.classList.add('active');
                card.classList.remove('inactive');
                dot.classList.add('active');
                dot.classList.remove('inactive');
                details.innerHTML = `
                    <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong style="color: #10b981;">æ­£å¸¸</strong></div>
                    <div>æœ€çµ‚å®Ÿè¡Œ: æ•°åˆ†å‰</div>
                    <div>æˆåŠŸç‡: 98%</div>
                `;
            } else {
                card.classList.add('inactive');
                card.classList.remove('active');
                dot.classList.add('inactive');
                dot.classList.remove('active');
                details.innerHTML = `
                    <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: <strong style="color: #ef4444;">æœªä½¿ç”¨</strong></div>
                    <div>æœ€çµ‚å®Ÿè¡Œ: -</div>
                    <div>æˆåŠŸç‡: -%</div>
                `;
            }
        }

        function updateCharts(data) {
            // Trend Chart (simplified)
            const trendCtx = document.getElementById('trendChart');
            if (charts.trend) charts.trend.destroy();
            charts.trend = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: data.slice(0, 10).map((d, i) => `å®Ÿè¡Œ${i+1}`),
                    datasets: [{
                        label: 'AIOè¡¨ç¤ºç‡',
                        data: data.slice(0, 10).map(d => d.aio_present ? 100 : 0),
                        borderColor: '#10b981',
                        tension: 0.4
                    }]
                },
                options: { responsive: true }
            });

            // LLM Performance Chart
            const llmPerfCtx = document.getElementById('llmPerfChart');
            if (charts.llmPerf) charts.llmPerf.destroy();

            const llmStats = { claude: 0, chatgpt: 0, gemini: 0 };
            data.forEach(d => {
                if (d.llm_results) {
                    d.llm_results.forEach(llm => {
                        if (llm.llm_own_cited) llmStats[llm.llm_engine]++;
                    });
                }
            });

            charts.llmPerf = new Chart(llmPerfCtx, {
                type: 'bar',
                data: {
                    labels: ['Claude', 'ChatGPT', 'Gemini'],
                    datasets: [{
                        label: 'å¼•ç”¨ç²å¾—æ•°',
                        data: [llmStats.claude, llmStats.chatgpt, llmStats.gemini],
                        backgroundColor: ['#ff6b35', '#10a37f', '#4285f4']
                    }]
                },
                options: { responsive: true }
            });
        }

        function addKeyword() {
            alert('ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¿½åŠ æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
        }

        function editKeyword(keyword) {
            alert(`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€Œ${keyword}ã€ã®ç·¨é›†æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™`);
        }

        function deleteKeyword(keyword) {
            if (confirm(`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€Œ${keyword}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
                alert('å‰Šé™¤æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
            }
        }

        function exportAllData() {
            if (!currentData) {
                alert('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“');
                return;
            }
            alert('CSVå‡ºåŠ›æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
        }

        function refreshData() {
            alert('ãƒ‡ãƒ¼ã‚¿æ›´æ–°æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
        }

        function clearLogs() {
            document.getElementById('system-logs').innerHTML = '<div class="log-entry"><span class="log-time">[' + new Date().toLocaleString() + ']</span><span class="log-level info">INFO</span><span>ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ</span></div>';
        }

        function addLog(level, message) {
            const logsContainer = document.getElementById('system-logs');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `
                <span class="log-time">[${new Date().toLocaleString()}]</span>
                <span class="log-level ${level}">${level.toUpperCase()}</span>
                <span>${message}</span>
            `;
            logsContainer.appendChild(entry);
            logsContainer.scrollTop = logsContainer.scrollHeight;
        }
    </script>
</body>
</html>
