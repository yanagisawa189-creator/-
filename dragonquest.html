<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éâ„É©„Ç¥„É≥„ÇØ„Ç®„Çπ„ÉàÈ¢®RPG</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'MS Gothic', monospace;
            background: linear-gradient(45deg, #1a472a, #2d5a3d);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            margin-top: 20px;
        }

        .title {
            text-align: center;
            font-size: 32px;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
            margin-bottom: 30px;
        }

        .player-status {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .status-left, .status-right {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .hp-bar, .mp-bar, .exp-bar {
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .hp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.3s ease;
        }

        .mp-fill {
            height: 100%;
            background: linear-gradient(90deg, #4444ff, #6666ff);
            transition: width 0.3s ease;
        }

        .exp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffaa00, #ffcc44);
            transition: width 0.3s ease;
        }

        .battle-area {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .enemy-info {
            font-size: 20px;
            margin-bottom: 15px;
            color: #fff;
            text-shadow: 2px 2px 4px #000;
        }

        .enemy-hp-bar {
            width: 300px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .enemy-hp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.3s ease;
        }

        .actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-btn {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border: 2px solid #ffd700;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px #000;
        }

        .action-btn:hover {
            background: linear-gradient(135deg, #047857, #059669);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .action-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .message-box {
            background: #1f2937;
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            min-height: 100px;
            overflow-y: auto;
            max-height: 200px;
        }

        .message {
            margin-bottom: 10px;
            padding: 5px;
            border-left: 3px solid #ffd700;
            padding-left: 10px;
        }

        .equipment {
            background: linear-gradient(135deg, #7c2d12, #dc2626);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .equipment h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .equipment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .level-up-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .level-up-content {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border: 4px solid #fff;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: #000;
            font-weight: bold;
        }

        .shop {
            background: linear-gradient(135deg, #581c87, #7c3aed);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .shop h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        .shop-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .shop-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .buy-btn {
            background: #059669;
            color: white;
            border: 1px solid #ffd700;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .buy-btn:hover {
            background: #047857;
        }

        .buy-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .player-status {
                grid-template-columns: 1fr;
            }
            
            .actions {
                grid-template-columns: 1fr;
            }
            
            .equipment-grid, .shop-items {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">üêâ „Éâ„É©„Ç¥„É≥„ÇØ„Ç®„Çπ„ÉàÈ¢®RPG üêâ</h1>
        
        <div class="player-status">
            <div class="status-left">
                <div class="status-item">
                    <span>ÂãáËÄÖ „É¨„Éô„É´ <span id="level">1</span></span>
                    <span>üí∞ <span id="gold">100</span>G</span>
                </div>
                <div class="status-item">
                    <span>HP</span>
                    <span><span id="currentHp">30</span>/<span id="maxHp">30</span></span>
                </div>
                <div class="hp-bar">
                    <div class="hp-fill" id="hpFill" style="width: 100%"></div>
                </div>
                <div class="status-item">
                    <span>MP</span>
                    <span><span id="currentMp">15</span>/<span id="maxMp">15</span></span>
                </div>
                <div class="mp-bar">
                    <div class="mp-fill" id="mpFill" style="width: 100%"></div>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item">
                    <span>ÊîªÊíÉÂäõ: <span id="attack">10</span></span>
                    <span>Èò≤Âæ°Âäõ: <span id="defense">5</span></span>
                </div>
                <div class="status-item">
                    <span>ÁµåÈ®ìÂÄ§</span>
                    <span><span id="currentExp">0</span>/<span id="nextExp">10</span></span>
                </div>
                <div class="exp-bar">
                    <div class="exp-fill" id="expFill" style="width: 0%"></div>
                </div>
                <div class="status-item">
                    <span>ÂãùÂà©Êï∞: <span id="victories">0</span></span>
                </div>
            </div>
        </div>

        <div class="battle-area">
            <div class="enemy-info" id="enemyInfo">
                <span id="enemyName">„Çπ„É©„Ç§„É†</span> „ÅåÁèæ„Çå„ÅüÔºÅ
            </div>
            <div class="enemy-hp-bar">
                <div class="enemy-hp-fill" id="enemyHpFill" style="width: 100%"></div>
            </div>
            <div id="enemyStats">HP: <span id="enemyCurrentHp">8</span>/<span id="enemyMaxHp">8</span></div>
        </div>

        <div class="actions">
            <button class="action-btn" onclick="attack()">‚öîÔ∏è „Åì„ÅÜ„Åí„Åç</button>
            <button class="action-btn" onclick="heal()" id="healBtn">‚ú® „Éõ„Ç§„Éü (3MP)</button>
            <button class="action-btn" onclick="defend()">üõ°Ô∏è „Åº„ÅÜ„Åé„Çá</button>
            <button class="action-btn" onclick="escape()">üí® „Å´„Åí„Çã</button>
        </div>

        <div class="message-box" id="messageBox">
            <div class="message">„Çà„ÅÜ„Åì„Åù„ÄÅÂãáËÄÖ„ÇàÔºÅÂÜíÈô∫„ÅÆÂßã„Åæ„Çä„Åß„Åô„ÄÇ</div>
        </div>

        <div class="equipment">
            <h3>‚öîÔ∏è Ë£ÖÂÇô</h3>
            <div class="equipment-grid">
                <div class="equipment-item">
                    <span>Ê≠¶Âô®:</span>
                    <span id="weapon">„Å≤„ÅÆ„Åç„ÅÆ„Åº„ÅÜ</span>
                </div>
                <div class="equipment-item">
                    <span>Èò≤ÂÖ∑:</span>
                    <span id="armor">„Å¨„ÅÆ„ÅÆ„Åµ„Åè</span>
                </div>
                <div class="equipment-item">
                    <span>Áõæ:</span>
                    <span id="shield">„Å™„Åó</span>
                </div>
                <div class="equipment-item">
                    <span>Ë£ÖÈ£æÂìÅ:</span>
                    <span id="accessory">„Å™„Åó</span>
                </div>
            </div>
        </div>

        <div class="shop">
            <h3>üè™ ÈÅìÂÖ∑Â±ã</h3>
            <div class="shop-items">
                <div class="shop-item">
                    <span>„ÇÑ„Åè„Åù„ÅÜ (HP+30)</span>
                    <span>8G <button class="buy-btn" onclick="buyItem('herb', 8)">Ë≥ºÂÖ•</button></span>
                </div>
                <div class="shop-item">
                    <span>„Åæ„Åª„ÅÜ„ÅÆ„Åø„Åö (MP+15)</span>
                    <span>20G <button class="buy-btn" onclick="buyItem('magicWater', 20)">Ë≥ºÂÖ•</button></span>
                </div>
                <div class="shop-item">
                    <span>„Åì„Çì„Åº„ÅÜ (Êîª+3)</span>
                    <span>60G <button class="buy-btn" onclick="buyItem('club', 60)">Ë≥ºÂÖ•</button></span>
                </div>
                <div class="shop-item">
                    <span>„Åã„Çè„ÅÆ„Çà„Çç„ÅÑ (ÂÆà+3)</span>
                    <span>80G <button class="buy-btn" onclick="buyItem('leatherArmor', 80)">Ë≥ºÂÖ•</button></span>
                </div>
            </div>
        </div>
    </div>

    <div class="level-up-modal" id="levelUpModal">
        <div class="level-up-content">
            <h2>üéâ „É¨„Éô„É´„Ç¢„ÉÉ„ÉóÔºÅ üéâ</h2>
            <p id="levelUpMessage"></p>
            <button onclick="closeLevelUp()" style="margin-top: 15px; padding: 10px 20px; background: #059669; color: white; border: none; border-radius: 5px; cursor: pointer;">OK</button>
        </div>
    </div>

    <script>
        // „Ç≤„Éº„É†„ÅÆÁä∂ÊÖãÁÆ°ÁêÜ
        let gameState = {
            player: {
                level: 1,
                hp: 30,
                maxHp: 30,
                mp: 15,
                maxMp: 15,
                attack: 10,
                defense: 5,
                exp: 0,
                nextExp: 10,
                gold: 100,
                victories: 0,
                items: {
                    herb: 0,
                    magicWater: 0
                },
                equipment: {
                    weapon: '„Å≤„ÅÆ„Åç„ÅÆ„Åº„ÅÜ',
                    armor: '„Å¨„ÅÆ„ÅÆ„Åµ„Åè',
                    shield: '„Å™„Åó',
                    accessory: '„Å™„Åó'
                }
            },
            enemy: null,
            inBattle: true,
            isPlayerTurn: true,
            isDefending: false
        };

        // „É¢„É≥„Çπ„Çø„Éº„ÅÆ„Éá„Éº„Çø
        const monsters = [
            { name: '„Çπ„É©„Ç§„É†', hp: 8, attack: 6, defense: 2, exp: 3, gold: 8 },
            { name: '„Åä„Åä„Åç„Å•„Å°', hp: 12, attack: 8, defense: 3, exp: 5, gold: 12 },
            { name: '„Éâ„É©„Ç≠„Éº', hp: 10, attack: 7, defense: 2, exp: 4, gold: 10 },
            { name: '„ÅÑ„Å£„Åã„Åè„ÅÜ„Åï„Åé', hp: 15, attack: 10, defense: 4, exp: 8, gold: 15 },
            { name: '„Åä„Åä„Å≠„Åö„Åø', hp: 18, attack: 12, defense: 5, exp: 12, gold: 20 },
            { name: '„É™„É™„Éë„ÉÉ„Éà', hp: 22, attack: 15, defense: 6, exp: 15, gold: 25 }
        ];

        // „Ç∑„Éß„ÉÉ„Éó„Ç¢„Ç§„ÉÜ„É†„ÅÆ„Éá„Éº„Çø
        const shopItems = {
            herb: { name: '„ÇÑ„Åè„Åù„ÅÜ', effect: () => heal(30, false), cost: 8 },
            magicWater: { name: '„Åæ„Åª„ÅÜ„ÅÆ„Åø„Åö', effect: () => restoreMp(15), cost: 20 },
            club: { 
                name: '„Åì„Çì„Åº„ÅÜ', 
                effect: () => equipWeapon('„Åì„Çì„Åº„ÅÜ', 3), 
                cost: 60 
            },
            leatherArmor: { 
                name: '„Åã„Çè„ÅÆ„Çà„Çç„ÅÑ', 
                effect: () => equipArmor('„Åã„Çè„ÅÆ„Çà„Çç„ÅÑ', 3), 
                cost: 80 
            }
        };

        // ÂàùÊúüÂåñ
        function initGame() {
            spawnEnemy();
            updateUI();
            addMessage('Êñ∞„Åó„ÅÑÊïµ„ÅåÁèæ„Çå„ÅüÔºÅ');
        }

        // Êïµ„ÇíÁîüÊàê
        function spawnEnemy() {
            const levelRange = Math.min(Math.floor(gameState.player.level / 2), monsters.length - 1);
            const randomIndex = Math.floor(Math.random() * (levelRange + 1));
            const monster = monsters[randomIndex];
            
            gameState.enemy = {
                ...monster,
                maxHp: monster.hp,
                currentHp: monster.hp
            };
            
            gameState.inBattle = true;
            gameState.isPlayerTurn = true;
        }

        // ÊîªÊíÉ
        function attack() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            const baseDamage = gameState.player.attack;
            const damage = Math.max(1, baseDamage - gameState.enemy.defense + Math.floor(Math.random() * 5));
            
            gameState.enemy.currentHp = Math.max(0, gameState.enemy.currentHp - damage);
            addMessage(`ÂãáËÄÖ„ÅÆÊîªÊíÉÔºÅ${gameState.enemy.name}„Å´${damage}„ÅÆ„ÉÄ„É°„Éº„Ç∏ÔºÅ`);
            
            if (gameState.enemy.currentHp <= 0) {
                victory();
                return;
            }
            
            gameState.isPlayerTurn = false;
            updateUI();
            
            setTimeout(() => {
                enemyTurn();
            }, 1000);
        }

        // ÂõûÂæ©
        function heal(amount = null, useMp = true) {
            if (useMp) {
                if (!gameState.isPlayerTurn || !gameState.inBattle || gameState.player.mp < 3) return;
                gameState.player.mp -= 3;
                amount = 15 + Math.floor(Math.random() * 10);
            }
            
            const actualHeal = Math.min(amount, gameState.player.maxHp - gameState.player.hp);
            gameState.player.hp += actualHeal;
            
            if (useMp) {
                addMessage(`„Éõ„Ç§„ÉüÔºÅHP„Åå${actualHeal}ÂõûÂæ©„Åó„ÅüÔºÅ`);
                gameState.isPlayerTurn = false;
                setTimeout(() => {
                    enemyTurn();
                }, 1000);
            } else {
                addMessage(`„ÇÑ„Åè„Åù„ÅÜ„Çí‰Ωø„Å£„ÅüÔºÅHP„Åå${actualHeal}ÂõûÂæ©„Åó„ÅüÔºÅ`);
            }
            
            updateUI();
        }

        // MPÂõûÂæ©
        function restoreMp(amount) {
            const actualRestore = Math.min(amount, gameState.player.maxMp - gameState.player.mp);
            gameState.player.mp += actualRestore;
            addMessage(`„Åæ„Åª„ÅÜ„ÅÆ„Åø„Åö„Çí‰Ωø„Å£„ÅüÔºÅMP„Åå${actualRestore}ÂõûÂæ©„Åó„ÅüÔºÅ`);
            updateUI();
        }

        // Èò≤Âæ°
        function defend() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            gameState.isDefending = true;
            addMessage('ÂãáËÄÖ„ÅØË∫´„ÇíÂÆà„Å£„Å¶„ÅÑ„ÇãÔºÅ');
            
            gameState.isPlayerTurn = false;
            updateUI();
            
            setTimeout(() => {
                enemyTurn();
            }, 1000);
        }

        // ÈÄÉ„Åí„Çã
        function escape() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            if (Math.random() < 0.7) {
                addMessage('„ÅÜ„Åæ„ÅèÈÄÉ„ÅíÂàá„Å£„ÅüÔºÅ');
                setTimeout(() => {
                    spawnEnemy();
                    updateUI();
                }, 1500);
            } else {
                addMessage('ÈÄÉ„Åí„Çâ„Çå„Å™„Åã„Å£„ÅüÔºÅ');
                gameState.isPlayerTurn = false;
                setTimeout(() => {
                    enemyTurn();
                }, 1000);
            }
        }

        // Êïµ„ÅÆ„Çø„Éº„É≥
        function enemyTurn() {
            if (!gameState.inBattle) return;
            
            const damage = Math.max(1, gameState.enemy.attack - gameState.player.defense - (gameState.isDefending ? 3 : 0));
            const actualDamage = Math.max(1, damage + Math.floor(Math.random() * 3) - 1);
            
            gameState.player.hp = Math.max(0, gameState.player.hp - actualDamage);
            
            let message = `${gameState.enemy.name}„ÅÆÊîªÊíÉÔºÅÂãáËÄÖ„Å´${actualDamage}„ÅÆ„ÉÄ„É°„Éº„Ç∏ÔºÅ`;
            if (gameState.isDefending) {
                message += 'ÔºàÈò≤Âæ°ÂäπÊûú„ÅßËªΩÊ∏õÔºÅÔºâ';
            }
            addMessage(message);
            
            if (gameState.player.hp <= 0) {
                defeat();
                return;
            }
            
            gameState.isDefending = false;
            gameState.isPlayerTurn = true;
            updateUI();
        }

        // ÂãùÂà©
        function victory() {
            gameState.inBattle = false;
            gameState.player.victories++;
            
            const expGained = gameState.enemy.exp;
            const goldGained = gameState.enemy.gold + Math.floor(Math.random() * 5);
            
            gameState.player.exp += expGained;
            gameState.player.gold += goldGained;
            
            addMessage(`${gameState.enemy.name}„ÇíÂÄí„Åó„ÅüÔºÅ`);
            addMessage(`${expGained}„ÅÆÁµåÈ®ìÂÄ§„Å®${goldGained}„Ç¥„Éº„É´„Éâ„ÇíÊâã„Å´ÂÖ•„Çå„ÅüÔºÅ`);
            
            checkLevelUp();
            
            setTimeout(() => {
                spawnEnemy();
                updateUI();
            }, 2000);
        }

        // ÊïóÂåó
        function defeat() {
            gameState.inBattle = false;
            addMessage('ÂãáËÄÖ„ÅØÂäõÂ∞Ω„Åç„Åü...');
            addMessage('Êïô‰ºö„ÅßÁîü„ÅçËøî„Å£„ÅüÔºÅ„Ç¥„Éº„É´„Éâ„ÅåÂçäÂàÜ„Å´„Å™„Å£„Å¶„Åó„Åæ„Å£„Åü...');
            
            gameState.player.hp = gameState.player.maxHp;
            gameState.player.mp = gameState.player.maxMp;
            gameState.player.gold = Math.floor(gameState.player.gold / 2);
            
            setTimeout(() => {
                spawnEnemy();
                updateUI();
            }, 3000);
        }

        // „É¨„Éô„É´„Ç¢„ÉÉ„Éó„ÉÅ„Çß„ÉÉ„ÇØ
        function checkLevelUp() {
            if (gameState.player.exp >= gameState.player.nextExp) {
                levelUp();
            }
        }

        // „É¨„Éô„É´„Ç¢„ÉÉ„Éó
        function levelUp() {
            gameState.player.level++;
            gameState.player.exp -= gameState.player.nextExp;
            gameState.player.nextExp = gameState.player.level * 8 + 2;
            
            const hpIncrease = 5 + Math.floor(Math.random() * 8);
            const mpIncrease = 2 + Math.floor(Math.random() * 4);
            const attackIncrease = 2 + Math.floor(Math.random() * 3);
            const defenseIncrease = 1 + Math.floor(Math.random() * 2);
            
            gameState.player.maxHp += hpIncrease;
            gameState.player.hp = gameState.player.maxHp;
            gameState.player.maxMp += mpIncrease;
            gameState.player.mp = gameState.player.maxMp;
            gameState.player.attack += attackIncrease;
            gameState.player.defense += defenseIncrease;
            
            const message = `„É¨„Éô„É´${gameState.player.level}„Å´„Å™„Å£„ÅüÔºÅ\nHP+${hpIncrease} MP+${mpIncrease}\nÊîªÊíÉÂäõ+${attackIncrease} Èò≤Âæ°Âäõ+${defenseIncrease}`;
            
            document.getElementById('levelUpMessage').innerText = message;
            document.getElementById('levelUpModal').style.display = 'flex';
            
            if (gameState.player.exp >= gameState.player.nextExp) {
                setTimeout(() => levelUp(), 100);
            }
        }

        function closeLevelUp() {
            document.getElementById('levelUpModal').style.display = 'none';
        }

        // Ë£ÖÂÇôÂ§âÊõ¥
        function equipWeapon(name, attackBonus) {
            if (gameState.player.equipment.weapon !== '„Å≤„ÅÆ„Åç„ÅÆ„Åº„ÅÜ') {
                gameState.player.attack -= getEquipmentBonus(gameState.player.equipment.weapon);
            } else {
                gameState.player.attack -= 0;
            }
            
            gameState.player.equipment.weapon = name;
            gameState.player.attack += attackBonus;
            addMessage(`${name}„ÇíË£ÖÂÇô„Åó„ÅüÔºÅÊîªÊíÉÂäõ„Åå${attackBonus}‰∏ä„Åå„Å£„ÅüÔºÅ`);
            updateUI();
        }

        function equipArmor(name, defenseBonus) {
            if (gameState.player.equipment.armor !== '„Å¨„ÅÆ„ÅÆ„Åµ„Åè') {
                gameState.player.defense -= getEquipmentBonus(gameState.player.equipment.armor);
            } else {
                gameState.player.defense -= 0;
            }
            
            gameState.player.equipment.armor = name;
            gameState.player.defense += defenseBonus;
            addMessage(`${name}„ÇíË£ÖÂÇô„Åó„ÅüÔºÅÈò≤Âæ°Âäõ„Åå${defenseBonus}‰∏ä„Åå„Å£„ÅüÔºÅ`);
            updateUI();
        }

        function getEquipmentBonus(equipmentName) {
            const bonuses = {
                '„Åì„Çì„Åº„ÅÜ': 3,
                '„Åã„Çè„ÅÆ„Çà„Çç„ÅÑ': 3
            };
            return bonuses[equipmentName] || 0;
        }

        // „Ç¢„Ç§„ÉÜ„É†Ë≥ºÂÖ•
        function buyItem(itemKey, cost) {
            if (gameState.player.gold < cost) {
                addMessage('„Ç¥„Éº„É´„Éâ„ÅåË∂≥„Çä„Åæ„Åõ„ÇìÔºÅ');
                return;
            }
            
            gameState.player.gold -= cost;
            const item = shopItems[itemKey];
            
            if (itemKey === 'herb' || itemKey === 'magicWater') {
                gameState.player.items[itemKey]++;
                addMessage(`${item.name}„ÇíË≥ºÂÖ•„Åó„ÅüÔºÅ`);
            } else {
                item.effect();
            }
            
            updateUI();
        }

        // „É°„ÉÉ„Çª„Éº„Ç∏ËøΩÂä†
        function addMessage(message) {
            const messageBox = document.getElementById('messageBox');
            const messageElement = document.createElement('div');
            messageElement.className = 'message';
            messageElement.textContent = message;
            messageBox.appendChild(messageElement);
            messageBox.scrollTop = messageBox.scrollHeight;
            
            // „É°„ÉÉ„Çª„Éº„Ç∏Êï∞„ÇíÂà∂Èôê
            if (messageBox.children.length > 10) {
                messageBox.removeChild(messageBox.firstChild);
            }
        }

        // UIÊõ¥Êñ∞
        function updateUI() {
            // „Éó„É¨„Ç§„É§„ÉºÊÉÖÂ†±
            document.getElementById('level').textContent = gameState.player.level;
            document.getElementById('currentHp').textContent = gameState.player.hp;
            document.getElementById('maxHp').textContent = gameState.player.maxHp;
            document.getElementById('currentMp').textContent = gameState.player.mp;
            document.getElementById('maxMp').textContent = gameState.player.maxMp;
            document.getElementById('attack').textContent = gameState.player.attack;
            document.getElementById('defense').textContent = gameState.player.defense;
            document.getElementById('currentExp').textContent = gameState.player.exp;
            document.getElementById('nextExp').textContent = gameState.player.nextExp;
            document.getElementById('gold').textContent = gameState.player.gold;
            document.getElementById('victories').textContent = gameState.player.victories;

            // HP„Éê„Éº
            const hpPercent = (gameState.player.hp / gameState.player.maxHp) * 100;
            document.getElementById('hpFill').style.width = hpPercent + '%';

            // MP„Éê„Éº
            const mpPercent = (gameState.player.mp / gameState.player.maxMp) * 100;
            document.getElementById('mpFill').style.width = mpPercent + '%';

            // ÁµåÈ®ìÂÄ§„Éê„Éº
            const expPercent = (gameState.player.exp / gameState.player.nextExp) * 100;
            document.getElementById('expFill').style.width = expPercent + '%';

            // ÊïµÊÉÖÂ†±
            if (gameState.enemy) {
                document.getElementById('enemyName').textContent = gameState.enemy.name;
                document.getElementById('enemyCurrentHp').textContent = gameState.enemy.currentHp;
                document.getElementById('enemyMaxHp').textContent = gameState.enemy.maxHp;
                
                const enemyHpPercent = (gameState.enemy.currentHp / gameState.enemy.maxHp) * 100;
                document.getElementById('enemyHpFill').style.width = enemyHpPercent + '%';
            }

            // Ë£ÖÂÇôÊÉÖÂ†±
            document.getElementById('weapon').textContent = gameState.player.equipment.weapon;
            document.getElementById('armor').textContent = gameState.player.equipment.armor;
            document.getElementById('shield').textContent = gameState.player.equipment.shield;
            document.getElementById('accessory').textContent = gameState.player.equipment.accessory;

            // „Éú„Çø„É≥Áä∂ÊÖã
            document.getElementById('healBtn').disabled = gameState.player.mp < 3;
            
            // „Ç∑„Éß„ÉÉ„Éó„Éú„Çø„É≥„ÅÆÁä∂ÊÖãÊõ¥Êñ∞
            updateShopButtons();
        }

        function updateShopButtons() {
            const buttons = document.querySelectorAll('.buy-btn');
            buttons.forEach((button, index) => {
                const costs = [8, 20, 60, 80];
                button.disabled = gameState.player.gold < costs[index];
            });
        }

        // „Ç≤„Éº„É†ÈñãÂßã
        initGame();
        
        // „Ç™„Éº„Éà„Çª„Éº„ÉñÔºàÁ∞°ÊòìÁâàÔºâ
        setInterval(() => {
            localStorage.setItem('dragonquest_save', JSON.stringify(gameState));
        }, 10000);

        // „Éö„Éº„Ç∏„É≠„Éº„ÉâÊôÇ„Å´„Çª„Éº„Éñ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø
        window.addEventListener('load', () => {
            const savedData = localStorage.getItem('dragonquest_save');
            if (savedData) {
                try {
                    const loaded = JSON.parse(savedData);
                    Object.assign(gameState, loaded);
                    updateUI();
                    addMessage('„Çª„Éº„Éñ„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„ÅüÔºÅ');
                } catch (e) {
                    console.log('„Çª„Éº„Éñ„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                }
            }
        });
    </script>
</body>
</html>