<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‰ãƒ©ã‚´ãƒ³ã‚¯ã‚¨ã‚¹ãƒˆé¢¨RPG</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'MS Gothic', monospace;
            background: linear-gradient(45deg, #1a472a, #2d5a3d);
            color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .game-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(0, 0, 0, 0.8);
            border-radius: 10px;
            margin-top: 20px;
        }

        .title {
            text-align: center;
            font-size: 32px;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
            margin-bottom: 30px;
        }

        .player-status {
            background: linear-gradient(135deg, #1e3a8a, #3b82f6);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .status-left, .status-right {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .hp-bar, .mp-bar, .exp-bar {
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .hp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.3s ease;
        }

        .mp-fill {
            height: 100%;
            background: linear-gradient(90deg, #4444ff, #6666ff);
            transition: width 0.3s ease;
        }

        .exp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffaa00, #ffcc44);
            transition: width 0.3s ease;
        }

        .battle-area {
            background: linear-gradient(135deg, #8b5cf6, #a78bfa);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .enemy-info {
            font-size: 20px;
            margin-bottom: 15px;
            color: #fff;
            text-shadow: 2px 2px 4px #000;
        }

        .enemy-hp-bar {
            width: 300px;
            height: 20px;
            background: #333;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .enemy-hp-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4444, #ff6666);
            transition: width 0.3s ease;
        }

        .actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .action-btn {
            background: linear-gradient(135deg, #059669, #10b981);
            color: white;
            border: 2px solid #ffd700;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px #000;
        }

        .action-btn:hover {
            background: linear-gradient(135deg, #047857, #059669);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .action-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .message-box {
            background: #1f2937;
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            min-height: 100px;
            overflow-y: auto;
            max-height: 200px;
        }

        .message {
            margin-bottom: 10px;
            padding: 5px;
            border-left: 3px solid #ffd700;
            padding-left: 10px;
        }

        .equipment {
            background: linear-gradient(135deg, #7c2d12, #dc2626);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .equipment h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        .equipment-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .equipment-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 5px;
        }

        .level-up-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .level-up-content {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            border: 4px solid #fff;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: #000;
            font-weight: bold;
        }

        .shop {
            background: linear-gradient(135deg, #581c87, #7c3aed);
            border: 3px solid #ffd700;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .shop h3 {
            color: #ffd700;
            margin-bottom: 15px;
            text-align: center;
        }

        .shop-items {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .shop-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .buy-btn {
            background: #059669;
            color: white;
            border: 1px solid #ffd700;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .buy-btn:hover {
            background: #047857;
        }

        .buy-btn:disabled {
            background: #666;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .player-status {
                grid-template-columns: 1fr;
            }
            
            .actions {
                grid-template-columns: 1fr;
            }
            
            .equipment-grid, .shop-items {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1 class="title">ğŸ‰ ãƒ‰ãƒ©ã‚´ãƒ³ã‚¯ã‚¨ã‚¹ãƒˆé¢¨RPG ğŸ‰</h1>
        
        <div class="player-status">
            <div class="status-left">
                <div class="status-item">
                    <span>å‹‡è€… ãƒ¬ãƒ™ãƒ« <span id="level">1</span></span>
                    <span>ğŸ’° <span id="gold">100</span>G</span>
                </div>
                <div class="status-item">
                    <span>HP</span>
                    <span><span id="currentHp">30</span>/<span id="maxHp">30</span></span>
                </div>
                <div class="hp-bar">
                    <div class="hp-fill" id="hpFill" style="width: 100%"></div>
                </div>
                <div class="status-item">
                    <span>MP</span>
                    <span><span id="currentMp">15</span>/<span id="maxMp">15</span></span>
                </div>
                <div class="mp-bar">
                    <div class="mp-fill" id="mpFill" style="width: 100%"></div>
                </div>
            </div>
            <div class="status-right">
                <div class="status-item">
                    <span>æ”»æ’ƒåŠ›: <span id="attack">10</span></span>
                    <span>é˜²å¾¡åŠ›: <span id="defense">5</span></span>
                </div>
                <div class="status-item">
                    <span>çµŒé¨“å€¤</span>
                    <span><span id="currentExp">0</span>/<span id="nextExp">10</span></span>
                </div>
                <div class="exp-bar">
                    <div class="exp-fill" id="expFill" style="width: 0%"></div>
                </div>
                <div class="status-item">
                    <span>å‹åˆ©æ•°: <span id="victories">0</span></span>
                </div>
            </div>
        </div>

        <div class="battle-area">
            <div class="enemy-info" id="enemyInfo">
                <span id="enemyName">ã‚¹ãƒ©ã‚¤ãƒ </span> ãŒç¾ã‚ŒãŸï¼
            </div>
            <div class="enemy-hp-bar">
                <div class="enemy-hp-fill" id="enemyHpFill" style="width: 100%"></div>
            </div>
            <div id="enemyStats">HP: <span id="enemyCurrentHp">8</span>/<span id="enemyMaxHp">8</span></div>
        </div>

        <div class="actions">
            <button class="action-btn" onclick="attack()">âš”ï¸ ã“ã†ã’ã</button>
            <button class="action-btn" onclick="heal()" id="healBtn">âœ¨ ãƒ›ã‚¤ãƒŸ (3MP)</button>
            <button class="action-btn" onclick="defend()">ğŸ›¡ï¸ ã¼ã†ãã‚‡</button>
            <button class="action-btn" onclick="escape()">ğŸ’¨ ã«ã’ã‚‹</button>
        </div>

        <div class="message-box" id="messageBox">
            <div class="message">ã‚ˆã†ã“ãã€å‹‡è€…ã‚ˆï¼å†’é™ºã®å§‹ã¾ã‚Šã§ã™ã€‚</div>
        </div>

        <div class="equipment">
            <h3>âš”ï¸ è£…å‚™</h3>
            <div class="equipment-grid">
                <div class="equipment-item">
                    <span>æ­¦å™¨:</span>
                    <span id="weapon">ã²ã®ãã®ã¼ã†</span>
                </div>
                <div class="equipment-item">
                    <span>é˜²å…·:</span>
                    <span id="armor">ã¬ã®ã®ãµã</span>
                </div>
                <div class="equipment-item">
                    <span>ç›¾:</span>
                    <span id="shield">ãªã—</span>
                </div>
                <div class="equipment-item">
                    <span>è£…é£¾å“:</span>
                    <span id="accessory">ãªã—</span>
                </div>
            </div>
        </div>

        <div class="shop">
            <h3>ğŸª é“å…·å±‹</h3>
            <div class="shop-items">
                <div class="shop-item">
                    <span>ã‚„ããã† (HP+30)</span>
                    <span>8G <button class="buy-btn" onclick="buyItem('herb', 8)">è³¼å…¥</button></span>
                </div>
                <div class="shop-item">
                    <span>ã¾ã»ã†ã®ã¿ãš (MP+15)</span>
                    <span>20G <button class="buy-btn" onclick="buyItem('magicWater', 20)">è³¼å…¥</button></span>
                </div>
                <div class="shop-item">
                    <span>ã“ã‚“ã¼ã† (æ”»+3)</span>
                    <span>60G <button class="buy-btn" onclick="buyItem('club', 60)">è³¼å…¥</button></span>
                </div>
                <div class="shop-item">
                    <span>ã‹ã‚ã®ã‚ˆã‚ã„ (å®ˆ+3)</span>
                    <span>80G <button class="buy-btn" onclick="buyItem('leatherArmor', 80)">è³¼å…¥</button></span>
                </div>
            </div>
        </div>
    </div>

    <div class="level-up-modal" id="levelUpModal">
        <div class="level-up-content">
            <h2>ğŸ‰ ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ï¼ ğŸ‰</h2>
            <p id="levelUpMessage"></p>
            <button onclick="closeLevelUp()" style="margin-top: 15px; padding: 10px 20px; background: #059669; color: white; border: none; border-radius: 5px; cursor: pointer;">OK</button>
        </div>
    </div>

    <script>
        // ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†
        let gameState = {
            player: {
                level: 1,
                hp: 30,
                maxHp: 30,
                mp: 15,
                maxMp: 15,
                attack: 10,
                defense: 5,
                exp: 0,
                nextExp: 10,
                gold: 100,
                victories: 0,
                items: {
                    herb: 0,
                    magicWater: 0
                },
                equipment: {
                    weapon: 'ã²ã®ãã®ã¼ã†',
                    armor: 'ã¬ã®ã®ãµã',
                    shield: 'ãªã—',
                    accessory: 'ãªã—'
                }
            },
            enemy: null,
            inBattle: true,
            isPlayerTurn: true,
            isDefending: false
        };

        // ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿
        const monsters = [
            { name: 'ã‚¹ãƒ©ã‚¤ãƒ ', hp: 8, attack: 6, defense: 2, exp: 3, gold: 8 },
            { name: 'ãŠãŠãã¥ã¡', hp: 12, attack: 8, defense: 3, exp: 5, gold: 12 },
            { name: 'ãƒ‰ãƒ©ã‚­ãƒ¼', hp: 10, attack: 7, defense: 2, exp: 4, gold: 10 },
            { name: 'ã„ã£ã‹ãã†ã•ã', hp: 15, attack: 10, defense: 4, exp: 8, gold: 15 },
            { name: 'ãŠãŠã­ãšã¿', hp: 18, attack: 12, defense: 5, exp: 12, gold: 20 },
            { name: 'ãƒªãƒªãƒ‘ãƒƒãƒˆ', hp: 22, attack: 15, defense: 6, exp: 15, gold: 25 }
        ];

        // ã‚·ãƒ§ãƒƒãƒ—ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ‡ãƒ¼ã‚¿
        const shopItems = {
            herb: { name: 'ã‚„ããã†', effect: () => heal(30, false), cost: 8 },
            magicWater: { name: 'ã¾ã»ã†ã®ã¿ãš', effect: () => restoreMp(15), cost: 20 },
            club: { 
                name: 'ã“ã‚“ã¼ã†', 
                effect: () => equipWeapon('ã“ã‚“ã¼ã†', 3), 
                cost: 60 
            },
            leatherArmor: { 
                name: 'ã‹ã‚ã®ã‚ˆã‚ã„', 
                effect: () => equipArmor('ã‹ã‚ã®ã‚ˆã‚ã„', 3), 
                cost: 80 
            }
        };

        // åˆæœŸåŒ–
        function initGame() {
            spawnEnemy();
            updateUI();
            addMessage('æ–°ã—ã„æ•µãŒç¾ã‚ŒãŸï¼');
        }

        // æ•µã‚’ç”Ÿæˆ
        function spawnEnemy() {
            const levelRange = Math.min(Math.floor(gameState.player.level / 2), monsters.length - 1);
            const randomIndex = Math.floor(Math.random() * (levelRange + 1));
            const monster = monsters[randomIndex];
            
            gameState.enemy = {
                ...monster,
                maxHp: monster.hp,
                currentHp: monster.hp
            };
            
            gameState.inBattle = true;
            gameState.isPlayerTurn = true;
        }

        // æ”»æ’ƒ
        function attack() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            const baseDamage = gameState.player.attack;
            const damage = Math.max(1, baseDamage - gameState.enemy.defense + Math.floor(Math.random() * 5));
            
            gameState.enemy.currentHp = Math.max(0, gameState.enemy.currentHp - damage);
            addMessage(`å‹‡è€…ã®æ”»æ’ƒï¼${gameState.enemy.name}ã«${damage}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`);
            
            if (gameState.enemy.currentHp <= 0) {
                victory();
                return;
            }
            
            gameState.isPlayerTurn = false;
            updateUI();
            
            setTimeout(() => {
                enemyTurn();
            }, 1000);
        }

        // å›å¾©
        function heal(amount = null, useMp = true) {
            if (useMp) {
                if (!gameState.isPlayerTurn || !gameState.inBattle || gameState.player.mp < 3) return;
                gameState.player.mp -= 3;
                amount = 15 + Math.floor(Math.random() * 10);
            }
            
            const actualHeal = Math.min(amount, gameState.player.maxHp - gameState.player.hp);
            gameState.player.hp += actualHeal;
            
            if (useMp) {
                addMessage(`ãƒ›ã‚¤ãƒŸï¼HPãŒ${actualHeal}å›å¾©ã—ãŸï¼`);
                gameState.isPlayerTurn = false;
                setTimeout(() => {
                    enemyTurn();
                }, 1000);
            } else {
                addMessage(`ã‚„ããã†ã‚’ä½¿ã£ãŸï¼HPãŒ${actualHeal}å›å¾©ã—ãŸï¼`);
            }
            
            updateUI();
        }

        // MPå›å¾©
        function restoreMp(amount) {
            const actualRestore = Math.min(amount, gameState.player.maxMp - gameState.player.mp);
            gameState.player.mp += actualRestore;
            addMessage(`ã¾ã»ã†ã®ã¿ãšã‚’ä½¿ã£ãŸï¼MPãŒ${actualRestore}å›å¾©ã—ãŸï¼`);
            updateUI();
        }

        // é˜²å¾¡
        function defend() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            gameState.isDefending = true;
            addMessage('å‹‡è€…ã¯èº«ã‚’å®ˆã£ã¦ã„ã‚‹ï¼');
            
            gameState.isPlayerTurn = false;
            updateUI();
            
            setTimeout(() => {
                enemyTurn();
            }, 1000);
        }

        // é€ƒã’ã‚‹
        function escape() {
            if (!gameState.isPlayerTurn || !gameState.inBattle) return;
            
            if (Math.random() < 0.7) {
                addMessage('ã†ã¾ãé€ƒã’åˆ‡ã£ãŸï¼');
                setTimeout(() => {
                    spawnEnemy();
                    updateUI();
                }, 1500);
            } else {
                addMessage('é€ƒã’ã‚‰ã‚Œãªã‹ã£ãŸï¼');
                gameState.isPlayerTurn = false;
                setTimeout(() => {
                    enemyTurn();
                }, 1000);
            }
        }

        // æ•µã®ã‚¿ãƒ¼ãƒ³
        function enemyTurn() {
            if (!gameState.inBattle) return;
            
            const damage = Math.max(1, gameState.enemy.attack - gameState.player.defense - (gameState.isDefending ? 3 : 0));
            const actualDamage = Math.max(1, damage + Math.floor(Math.random() * 3) - 1);
            
            gameState.player.hp = Math.max(0, gameState.player.hp - actualDamage);
            
            let message = `${gameState.enemy.name}ã®æ”»æ’ƒï¼å‹‡è€…ã«${actualDamage}ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼`;
            if (gameState.isDefending) {
                message += 'ï¼ˆé˜²å¾¡åŠ¹æœã§è»½æ¸›ï¼ï¼‰';
            }
            addMessage(message);
            
            if (gameState.player.hp <= 0) {
                defeat();
                return;
            }
            
            gameState.isDefending = false;
            gameState.isPlayerTurn = true;
            updateUI();
        }

        // å‹åˆ©
        function victory() {
            gameState.inBattle = false;
            gameState.player.victories++;
            
            const expGained = gameState.enemy.exp;
            const goldGained = gameState.enemy.gold + Math.floor(Math.random() * 5);
            
            gameState.player.exp += expGained;
            gameState.player.gold += goldGained;
            
            addMessage(`${gameState.enemy.name}ã‚’å€’ã—ãŸï¼`);
            addMessage(`${expGained}ã®çµŒé¨“å€¤ã¨${goldGained}ã‚´ãƒ¼ãƒ«ãƒ‰ã‚’æ‰‹ã«å…¥ã‚ŒãŸï¼`);
            
            checkLevelUp();
            
            setTimeout(() => {
                spawnEnemy();
                updateUI();
            }, 2000);
        }

        // æ•—åŒ—
        function defeat() {
            gameState.inBattle = false;
            addMessage('å‹‡è€…ã¯åŠ›å°½ããŸ...');
            addMessage('æ•™ä¼šã§ç”Ÿãè¿”ã£ãŸï¼ã‚´ãƒ¼ãƒ«ãƒ‰ãŒåŠåˆ†ã«ãªã£ã¦ã—ã¾ã£ãŸ...');
            
            gameState.player.hp = gameState.player.maxHp;
            gameState.player.mp = gameState.player.maxMp;
            gameState.player.gold = Math.floor(gameState.player.gold / 2);
            
            setTimeout(() => {
                spawnEnemy();
                updateUI();
            }, 3000);
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—ãƒã‚§ãƒƒã‚¯
        function checkLevelUp() {
            if (gameState.player.exp >= gameState.player.nextExp) {
                levelUp();
            }
        }

        // ãƒ¬ãƒ™ãƒ«ã‚¢ãƒƒãƒ—
        function levelUp() {
            gameState.player.level++;
            gameState.player.exp -= gameState.player.nextExp;
            gameState.player.nextExp = gameState.player.level * 8 + 2;
            
            const hpIncrease = 5 + Math.floor(Math.random() * 8);
            const mpIncrease = 2 + Math.floor(Math.random() * 4);
            const attackIncrease = 2 + Math.floor(Math.random() * 3);
            const defenseIncrease = 1 + Math.floor(Math.random() * 2);
            
            gameState.player.maxHp += hpIncrease;
            gameState.player.hp = gameState.player.maxHp;
            gameState.player.maxMp += mpIncrease;
            gameState.player.mp = gameState.player.maxMp;
            gameState.player.attack += attackIncrease;
            gameState.player.defense += defenseIncrease;
            
            const message = `ãƒ¬ãƒ™ãƒ«${gameState.player.level}ã«ãªã£ãŸï¼\nHP+${hpIncrease} MP+${mpIncrease}\næ”»æ’ƒåŠ›+${attackIncrease} é˜²å¾¡åŠ›+${defenseIncrease}`;
            
            document.getElementById('levelUpMessage').innerText = message;
            document.getElementById('levelUpModal').style.display = 'flex';
            
            if (gameState.player.exp >= gameState.player.nextExp) {
                setTimeout(() => levelUp(), 100);
            }
        }

        function closeLevelUp() {
            document.getElementById('levelUpModal').style.display = 'none';
        }

        // è£…å‚™å¤‰æ›´
        function equipWeapon(name, attackBonus) {
            if (gameState.player.equipment.weapon !== 'ã²ã®ãã®ã¼ã†') {
                gameState.player.attack -= getEquipmentBonus(gameState.player.equipment.weapon);
            } else {
                gameState.player.attack -= 0;
            }
            
            gameState.player.equipment.weapon = name;
            gameState.player.attack += attackBonus;
            addMessage(`${name}ã‚’è£…å‚™ã—ãŸï¼æ”»æ’ƒåŠ›ãŒ${attackBonus}ä¸ŠãŒã£ãŸï¼`);
            updateUI();
        }

        function equipArmor(name, defenseBonus) {
            if (gameState.player.equipment.armor !== 'ã¬ã®ã®ãµã') {
                gameState.player.defense -= getEquipmentBonus(gameState.player.equipment.armor);
            } else {
                gameState.player.defense -= 0;
            }
            
            gameState.player.equipment.armor = name;
            gameState.player.defense += defenseBonus;
            addMessage(`${name}ã‚’è£…å‚™ã—ãŸï¼é˜²å¾¡åŠ›ãŒ${defenseBonus}ä¸ŠãŒã£ãŸï¼`);
            updateUI();
        }

        function getEquipmentBonus(equipmentName) {
            const bonuses = {
                'ã“ã‚“ã¼ã†': 3,
                'ã‹ã‚ã®ã‚ˆã‚ã„': 3
            };
            return bonuses[equipmentName] || 0;
        }

        // ã‚¢ã‚¤ãƒ†ãƒ è³¼å…¥
        function buyItem(itemKey, cost) {
            if (gameState.player.gold < cost) {
                addMessage('ã‚´ãƒ¼ãƒ«ãƒ‰ãŒè¶³ã‚Šã¾ã›ã‚“ï¼');
                return;
            }
            
            gameState.player.gold -= cost;
            const item = shopItems[itemKey];
            
            if (itemKey === 'herb' || itemKey === 'magicWater') {
                gameState.player.items[itemKey]++;
                addMessage(`${item.name}ã‚’è³¼å…¥ã—ãŸï¼`);
            } else {
                item.effect();
            }
            
            updateUI();
        }

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
        function addMessage(message) {
            const messageBox = document.getElementById('messageBox');
            const messageElement = document.createElement('div');
            messageElement.className = 'message';
            messageElement.textContent = message;
            messageBox.appendChild(messageElement);
            messageBox.scrollTop = messageBox.scrollHeight;
            
            // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ã‚’åˆ¶é™
            if (messageBox.children.length > 10) {
                messageBox.removeChild(messageBox.firstChild);
            }
        }

        // UIæ›´æ–°
        function updateUI() {
            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±
            document.getElementById('level').textContent = gameState.player.level;
            document.getElementById('currentHp').textContent = gameState.player.hp;
            document.getElementById('maxHp').textContent = gameState.player.maxHp;
            document.getElementById('currentMp').textContent = gameState.player.mp;
            document.getElementById('maxMp').textContent = gameState.player.maxMp;
            document.getElementById('attack').textContent = gameState.player.attack;
            document.getElementById('defense').textContent = gameState.player.defense;
            document.getElementById('currentExp').textContent = gameState.player.exp;
            document.getElementById('nextExp').textContent = gameState.player.nextExp;
            document.getElementById('gold').textContent = gameState.player.gold;
            document.getElementById('victories').textContent = gameState.player.victories;

            // HPãƒãƒ¼
            const hpPercent = (gameState.player.hp / gameState.player.maxHp) * 100;
            document.getElementById('hpFill').style.width = hpPercent + '%';

            // MPãƒãƒ¼
            const mpPercent = (gameState.player.mp / gameState.player.maxMp) * 100;
            document.getElementById('mpFill').style.width = mpPercent + '%';

            // çµŒé¨“å€¤ãƒãƒ¼
            const expPercent = (gameState.player.exp / gameState.player.nextExp) * 100;
            document.getElementById('expFill').style.width = expPercent + '%';

            // æ•µæƒ…å ±
            if (gameState.enemy) {
                document.getElementById('enemyName').textContent = gameState.enemy.name;
                document.getElementById('enemyCurrentHp').textContent = gameState.enemy.currentHp;
                document.getElementById('enemyMaxHp').textContent = gameState.enemy.maxHp;
                
                const enemyHpPercent = (gameState.enemy.currentHp / gameState.enemy.maxHp) * 100;
                document.getElementById('enemyHpFill').style.width = enemyHpPercent + '%';
            }

            // è£…å‚™æƒ…å ±
            document.getElementById('weapon').textContent = gameState.player.equipment.weapon;
            document.getElementById('armor').textContent = gameState.player.equipment.armor;
            document.getElementById('shield').textContent = gameState.player.equipment.shield;
            document.getElementById('accessory').textContent = gameState.player.equipment.accessory;

            // ãƒœã‚¿ãƒ³çŠ¶æ…‹
            document.getElementById('healBtn').disabled = gameState.player.mp < 3;
            
            // ã‚·ãƒ§ãƒƒãƒ—ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
            updateShopButtons();
        }

        function updateShopButtons() {
            const buttons = document.querySelectorAll('.buy-btn');
            buttons.forEach((button, index) => {
                const costs = [8, 20, 60, 80];
                button.disabled = gameState.player.gold < costs[index];
            });
        }

        // ã‚²ãƒ¼ãƒ é–‹å§‹
        initGame();
        
        // ã‚ªãƒ¼ãƒˆã‚»ãƒ¼ãƒ–ï¼ˆç°¡æ˜“ç‰ˆï¼‰
        setInterval(() => {
            localStorage.setItem('dragonquest_save', JSON.stringify(gameState));
        }, 10000);

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        window.addEventListener('load', () => {
            const savedData = localStorage.getItem('dragonquest_save');
            if (savedData) {
                try {
                    const loaded = JSON.parse(savedData);
                    Object.assign(gameState, loaded);
                    updateUI();
                    addMessage('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼');
                } catch (e) {
                    console.log('ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
            }
        });
    </script>
</body>
</html>